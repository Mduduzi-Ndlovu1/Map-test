<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet Map with Compass</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-rotate@0.0.1/dist/leaflet-rotate.min.css" />
    <style>
        #map {
            height: 600px;
            width: 100%;
        }

        /* Style for the compass icon */
        #compass {
            position: absolute;
            bottom: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Compass_Rose.svg/1024px-Compass_Rose.svg.png'); /* Compass image */
            background-size: cover;
            transform-origin: center center;
            transition: transform 0.3s ease-in-out;
        }
    </style>
</head>
<body>

    <h1>Interactive Campus Map with Compass</h1>
    <div id="map"></div>
    <div id="compass"></div> <!-- Compass icon -->

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-rotate@0.0.1/dist/leaflet-rotate.min.js"></script>
    <script>
        // Initialize the map
        const map = L.map('map', {
            center: [40.730610, -73.935242], // Coordinates for campus center (example)
            zoom: 16,
            crs: L.CRS.EPSG3857, // Set the CRS
            dragging: true,
            zoomControl: true
        });

        // Tile layer from OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Enable the rotation of the map using touch gestures (with leaflet-rotate plugin)
        map.rotate = L.Rotate();
        map.addLayer(map.rotate); // Add the rotate layer to the map

        // Track the map's rotation and update the compass accordingly
        map.on('rotate', function() {
            // Get the current map rotation angle
            const rotationAngle = map.getBearing();

            // Update the compass icon's rotation based on the map's rotation
            document.getElementById("compass").style.transform = `rotate(${rotationAngle}deg)`;
        });

        // Optional: Adding a campus marker
        const campusMarker = L.marker([40.730610, -73.935242]).addTo(map);

        // Optional: Display some information about the marker
        campusMarker.bindPopup("Campus Center").openPopup();

    </script>

</body>
</html>
