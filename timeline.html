<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1pulse Online Map</title>
    <link rel="icon" href="https://1pulse.online/images/ipulse-logo.png" type="image/x-icon">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="all-styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="manifest" href="/manifest.json">
</head>
<body>
    <div id="map"></div>

    <!-- Dark Mode Toggle Button -->
    <button id="modal-button">
        <img src="https://1pulse.online/images/ipulse-logo.png" alt="1Pulse" style="width: 50px; height: 50px;">
    </button>

    <!-- Modal for Greater Johannesburg Neighborhood Oversight -->
    <div id="gjnoModal" class="gjno-modal">
        <div class="gjno-modal-content">
            <span class="gjno-close">&times;</span>
            <div class="cotainer">
                <!-- Section 1: Header, Search Bar, Hero Image -->
                <div class="section-1">
                    <header>
                        <h1>Community Resources Map</h1>
                    </header>
                    <div class="hero-image">
                        <img src="https://1pulse.online/images/1pulse-promo-map.png" alt="Community map image">
                    </div>
                    <div class="image-description">
                        <p>This map highlights key community issues and available resources. Explore the markers to find out more.</p>
                    </div>
                    <button id="install-button" style="display: none;">Install App</button>
                </div>

                <!-- Section 2: Resources Description -->
                <div class="section-2">
                    <header>
                        <div class="logo">
                            <img src="https://1pulse.online/images/ipulse-logo.png" alt="Logo">
                        </div>
                        <button id="guest-button">Guest</button>
                    </header>
                    <div class="hero-section">
                        <div class="carousel">
                            <div class="carousel-item">
                                <img src="https://via.placeholder.com/300x150" alt="Post Image">
                                <h3>User Name</h3>
                                <p>This is a sample post. It can contain text, images, or other content.</p>
                            </div>
                            <div class="carousel-item">
                                <img src="https://via.placeholder.com/300x150" alt="Post Image">
                                <h3>User Name</h3>
                                <p>Another sample post with different content.</p>
                            </div>
                            <div class="carousel-item">
                                <img src="https://via.placeholder.com/300x150" alt="Post Image">
                                <h3>User Name</h3>
                                <p>Yet another post for demonstration purposes.</p>
                            </div>
                        </div>
                        <div class="carousel-controls">
                            <button id="prev-button">&#10094;</button>
                            <button id="next-button">&#10095;</button>
                        </div>
                    </div>

                    <div class="faq-section">
                        <div class="overlay-container">
                            <div class="content-container">
                                <h3>Welcome to 1Pulse Online!</h3>
                                <p><span id="typingText" class="typing-text"><strong>The heartbeat of the community.</strong></span></p>
                                <div class="video-container">
                                    <iframe src="https://www.youtube.com/embed/fLQwwh5sSWQ" title="1Pulse Online Video" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                    <p>Watch this video to learn more about 1Pulse Online!</p>
                                </div>
                                <div class="faq">
                                    <button class="faq-question">What is 1Pulse Online?</button>
                                    <div class="faq-answer">
                                        <p>1Pulse Online is a map-driven platform that allows community members to post issues and track progress on resolutions.</p>
                                    </div>
                                </div>
                                <div class="cta-container">
                                    <a href="https://1pulse-online-beta.netlify.app/" class="cta-button">Proceed to Map</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 3: Markers and Sponsors -->
                <div class="section-3">
                    <div class="markers">
                        <h3>Marker Resources</h3>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for logos -->
    <div id="myModal" class="modal-brah">
        <div class="modal-content-brah">
            <span class="close-brah">&times;</span>
            <h2 class="modal-title-brah"></h2>
            <p class="modal-description-brah"></p>
            <div class="image-container">
                <img class="modal-image-brah" src="" alt="Modal Image">
            </div>
        </div>
    </div>

    <!-- Modal for creating a new post -->
    <div class="modal-overlay" id="modal-overlay"></div>
    <div class="modal" id="modal">
        <h3>Create a Post</h3>
        <form id="postForm" enctype="multipart/form-data">
        </form>
    </div>

    <!-- Modal for viewing a post -->
    <div class="modal-overlay" id="viewModal-overlay"></div>
    <div class="modal" id="viewModal">
        <div id="postDetails"></div>
        <h4>Comments:</h4>
        <div id="commentsList"></div>
        <form id="commentForm">
        </form>
    </div>

    <p id="gyroscope"></p>
    <div id="penIcon">
        <img src="compass.png" alt="Pen Icon">
    </div>

    <script>
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });

        let currentHeading = 0; 

        if (window.DeviceOrientationEvent) {
            window.addEventListener('deviceorientation', function(event) {
                const heading = event.alpha;
                if (heading !== null) {
                    document.getElementById("gyroscope").textContent = `Facing: ${Math.round(heading)}Â°`;
                    const penIcon = document.getElementById("penIcon");
                    penIcon.style.transform = `rotate(${heading}deg)`;
                }
            });
        } else {
            alert("Device Orientation is not supported on your device.");
        }

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js').then(() => {
                console.log('Service Worker registered');
            });
        }

        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('install-button').style.display = 'block';
        });

        document.getElementById('install-button').addEventListener('click', () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('App installed');
                    }
                    deferredPrompt = null;
                });
            }
        });
    </script>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="logic.js"></script>
</body>
</html>
